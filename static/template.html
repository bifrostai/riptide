{% from "section.html" import render_section %}
<!doctype html>
<html lang="en">
<head>
 <meta charset="utf-8">
 <title>{{ title }}</title>
 <link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900' rel='stylesheet' type='text/css'>
 <link href='http://fonts.googleapis.com/css?family=Fira+Code:400' rel='stylesheet' type='text/css'>
 <link rel="icon" type="image/png" href="https://cdn.sanity.io/images/p86pglis/production/c7435e346bfd6cb876a502467f23766b4b961279-34x34.png?w=256&h=256">
 <style type="text/css">
    {% include "style.css" %}
 </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <h1 class="title"><span class="gradient">Riptide</span><span class="light">Report</span></h1>
            <span class="subtitle">v0.2.0 | <a href="https://gitlab.com/bifrost-core/ai-team/riptide">source</a></span>
        </div>
        <div class="sidebar-items">
        {% for id, name in section_names.items() %}
            <a class="sidebar-button" href="#{{ id }}">{{ name }}</a>
        {% endfor %}
        </div>
    </div>
    <div class="main">
        {{ render_section(summary_section) }}
        {% for infobox in infoboxes %}
        <div class="infobox">
            <div class="infobox-title">{{ infobox['title'] }}</div>
            <div class="infobox-content">{{ infobox['content'] }}</div>
        </div>
        {% endfor %}
        {{ render_section(background_error_figs)}}
        {{ render_section(classification_error_figs)}}
        {{ render_section(localization_error_figs)}}
        {{ render_section(classification_and_localization_error_figs)}}
        {{ render_section(duplicate_error_figs)}}
        {{ render_section(missed_error_figs)}}
        <div id="MissedExtra">
            <h2>Classwise MissedErrors and recall</h2>
            <p>
                Number of MissedErrors per class | number of total objects per class
            </p>
            <div class="summary-row">
                {% for class_idx, individual_summary in classwise_summary.items() %}
                    {% set missed_error = individual_summary["MissedError"] %}
                    {% set total_count = individual_summary["total_count"] %}
                    <div class="summary-item">
                        <div class="summary-metric-title gradient">Class {{ class_idx }}</div>
                        <div class="summary-metric-value">{{ missed_error }} <span class="text-dark">| {{ total_count }}</span></div>
                    </div>
                {% endfor %}
            </div>
            <p>
                Recall per class
            </p>
            <div class="summary-row">
                {% for class_idx, individual_summary in classwise_summary.items() %}
                    <div class="summary-item">
                        <div class="summary-metric-title gradient">Class {{ class_idx }}</div>
                        <div class="summary-metric-value">{{ individual_summary['recall'] }}</span></div>
                    </div>
                {% endfor %}
            </div>
            <h2>Aspect ratio and size variance</h2>
            <p>
                Variance of aspect ratios across MissedErrors
            </p>
            <div class="summary-row">
                {% for class_idx, aspect_var in missed_aspect_var.items() %}
                <div class="summary-item">
                    <div class="summary-metric-title gradient">Class {{ class_idx }}</div>
                    <div class="summary-metric-value">{{ aspect_var }}</div>
                </div>
                {% endfor %}
            </div>
            <p>
                Variance of object size (area) across MissedErrors
            </p>
            <div class="summary-row">
                {% for class_idx, size_var in missed_size_var.items() %}
                <div class="summary-item">
                    <div class="summary-metric-title gradient">Class {{ class_idx }}</div>
                    <div class="summary-metric-value">{{ size_var }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
        {{ render_section(true_positive_figs) }}
        <div id="TrueExtra">
            <h2>Classwise True Positives</h2>
            <p>
                Number of True Positives per class | number of total objects per class
            </p>
            <div class="summary-row">
                {% for class_idx, individual_summary in classwise_summary.items() %}
                    {% set true_positives = individual_summary.get("true_positives", 0) %}
                    {% set total_count = individual_summary.get("total_count", 0) %}
                    <div class="summary-item">
                        <div class="summary-metric-title gradient">Class {{ class_idx }}</div>
                        <div class="summary-metric-value">{{ true_positives }} <span class="text-dark">| {{ total_count }}</span></div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
    <!-- <div class="info-panel">
        <div class="info-panel-header">
            <h2>Error Info</h2>
        </div>
        <div class="info-panel-content">
            {% for error_type, info in error_info.items() %}
                <div class="info-panel-content-summary">
                    <div class="info-panel-content-summary-title">
                        {{ error_type }}
                    </div>
                    {% for info_type, info_value in info.items() %}
                        {% if info_value is not none %}
                        <img class="info-panel-content-summary-image" src="data:image/png;base64,{{ info_value | safe }}">
                        {% endif %}
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
    </div> -->
</body>
</html>
